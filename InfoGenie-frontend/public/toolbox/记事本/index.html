<!doctype html>

<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>è®°äº‹æœ¬</title>
  <style>
    :root{
      /* æŸ”å’Œæ·¡ç»¿â€”é»„ç»¿è‰²ç³» */
      --g1:#effae6;  /* very light green */
      --g2:#e7f7dc;  /* pale spring green */
      --g3:#f3f9e1;  /* pale yellow-green */
      --ink:#1b3a2a; /* æ·±ç»¿è‰²æ–‡å­— */
      --muted:#2e5a43a8;
      --accent:#bfe7b8; /* è½»å¾®æŒ‰é’®åº•è‰² */
      --accent-press:#a9d7a2;
      --ring:#9fd79a88;
    }html,body{
  height:100%;
  -ms-overflow-style: none;
  scrollbar-width: none;
}
body{
  margin:0;
  color:var(--ink);
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "PingFang SC", "Noto Sans CJK SC", "Hiragino Sans GB", "Microsoft YaHei", Helvetica, Arial, sans-serif;
  background:
    radial-gradient(1200px 800px at 10% -10%, var(--g1), transparent 70%),
    radial-gradient(1000px 700px at 100% 20%, var(--g2), transparent 60%),
    linear-gradient(135deg, var(--g2), var(--g3));
  min-height: 100svh;
  min-height: 100dvh;
  display:flex; flex-direction:column;
}

.app{ display:flex; flex-direction:column; min-height:100vh; min-height:100svh; min-height:100dvh; }

.toolbar{
  position:sticky; top:0; z-index:10;
  display:flex; gap:.5rem; align-items:center; justify-content:flex-end;
  padding: max(12px, env(safe-area-inset-top)) max(12px, env(safe-area-inset-right)) 12px max(12px, env(safe-area-inset-left));
  background: linear-gradient(180deg, rgba(255,255,255,.55), rgba(255,255,255,.25));
  backdrop-filter: blur(8px);
  border-bottom: 1px solid #00000010;
}

.btn{
  -webkit-tap-highlight-color: transparent;
  appearance:none; border:none; cursor:pointer;
  padding: .6rem .9rem; border-radius: 14px;
  background: var(--accent);
  color: var(--ink); font-weight: 600; letter-spacing:.2px;
  box-shadow: 0 1px 0 #00000010, inset 0 0 0 1px #00000010;
  transition: transform .05s ease, background-color .15s ease, box-shadow .15s ease;
}
.btn:active{ transform: translateY(1px); background: var(--accent-press); }
.btn:focus-visible{ outline: none; box-shadow: 0 0 0 3px var(--ring); }

.main{
  /* ä½¿ç¼–è¾‘åŒºçºµå‘å……æ»¡å¯è§†åŒº */
  flex: 1 1 auto;
  display:grid;
  grid-template-rows: 1fr;
  padding: 0 max(12px, env(safe-area-inset-right)) max(12px, env(safe-area-inset-bottom)) max(12px, env(safe-area-inset-left));
}

/* ç¼–è¾‘å™¨å¤–å£³ */
.editor{
  align-self: stretch; justify-self: stretch;
  width: 100%;
  background: rgba(255,255,255,.55);
  border-radius: 18px;
  box-shadow: 0 10px 30px #00000010, inset 0 0 0 1px #00000010;
  display:grid;
  grid-template-columns: 1fr;
  overflow: visible; /* å› ä¸º textarea è‡ªé€‚åº”é«˜åº¦ï¼Œæ•´ä½“ç”±é¡µé¢æ»šåŠ¨ */
}

/* è¡Œå·æ  */
.gutter{
  --digits: 2; /* é€šè¿‡ JS åŠ¨æ€æ›´æ–° */
  padding: 14px 10px 14px 14px;
  min-width: calc(var(--digits) * 0.75ch + 22px);
  text-align: right;
  user-select: none;
  color: var(--muted);
  background: linear-gradient(180deg, rgba(255,255,255,.65), rgba(255,255,255,.35));
  border-top-left-radius: 18px; border-bottom-left-radius: 18px;
  border-right: 1px dashed #0000001a;
  font: 14px/1.6 ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  white-space: pre-wrap;
}

/* è®°äº‹æœ¬æ–‡æœ¬åŸŸ */
.pad{
  display:block; resize:none;
  padding: 14px 14px 14px 12px; /* å·¦ä¾§ç¨å°ä»¥è´´è¿‘è¡Œå· */
  margin:0; border:none; outline:none; background: transparent;
  width: 100%; height: auto; min-height: 40vh; /* åˆå§‹é«˜åº¦ï¼Œéšåç”± JS è‡ªé€‚åº” */
  font: 15px/1.6 ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  color: var(--ink);
  caret-color: #2c7a4b;
  tab-size: 2; /* åœ¨ç§»åŠ¨ç«¯ä¿æŒæ›´çŸ­ç¼©è¿› */
}
.pad::placeholder{ color:#2e5a4377; }
.pad:focus-visible{ outline:none; }

/* å¤åˆ¶æˆåŠŸæç¤º */
.toast{
  position: fixed; left: 50%; bottom: calc(16px + env(safe-area-inset-bottom)); transform: translateX(-50%) translateY(20px);
  background: rgba(46, 90, 67, .95);
  color: white; padding: 10px 14px; border-radius: 12px; font-size: 14px;
  box-shadow: 0 8px 24px #00000030;
  opacity: 0; pointer-events:none;
  transition: opacity .25s ease, transform .25s ease;
}
.toast.show{ opacity: 1; transform: translateX(-50%) translateY(0); }

html::-webkit-scrollbar, body::-webkit-scrollbar{ width: 0; height: 0; }
/* å°å±ä¼˜åŒ– */
@media (max-width: 700px){
  .toolbar{ justify-content: space-between; }
  .btn{ padding:.55rem .8rem; border-radius:12px; }
  .gutter{ font-size: 13px; }
  .pad{ font-size: 15px; line-height: 1.7; }
}

  </style>
</head>
<body>
  <div class="app" role="application" aria-label="æ·¡ç»¿è®°äº‹æœ¬">
    <div class="toolbar" aria-label="å·¥å…·æ ">
      <div style="margin-right:auto;font-weight:700;letter-spacing:.3px;opacity:.8">ğŸ“è®°äº‹æœ¬</div>
      <button id="copyBtn" class="btn" type="button" aria-label="ä¸€é”®å¤åˆ¶">å¤åˆ¶</button>
      <button id="clearBtn" class="btn" type="button" aria-label="ä¸€é”®æ¸…ç©º">æ¸…ç©º</button>
      <button id="exportBtn" class="btn" type="button" aria-label="å¯¼å‡ºä¸ºTXT">ä¸‹è½½</button>
    </div><main class="main">
  <section class="editor" aria-label="ç¼–è¾‘å™¨">

    <textarea id="pad" class="pad" spellcheck="false" placeholder="åœ¨è¿™é‡Œå¼€å§‹è®°ç¬”è®°"></textarea>
  </section>
</main>

  </div>  <div id="toast" class="toast" role="status" aria-live="polite">å·²å¤åˆ¶åˆ°å‰ªè´´æ¿</div>  <script>
    (function(){
      const pad = document.getElementById('pad');
      const clearBtn = document.getElementById('clearBtn');
      const copyBtn = document.getElementById('copyBtn');
      const exportBtn = document.getElementById('exportBtn');
      const toast = document.getElementById('toast');

      // è‡ªåŠ¨å¢é«˜ï¼šæ ¹æ®å†…å®¹è°ƒæ•´ textarea é«˜åº¦
      function autoResize(){
        pad.style.height = 'auto';
        // åœ¨ç§»åŠ¨ç«¯åŠ ä¸Šä¸€ç‚¹å†—ä½™ï¼Œé¿å…å…‰æ ‡è¢«é®æŒ¡
        const extra = 8; 
        pad.style.height = (pad.scrollHeight + extra) + 'px';
      }

      // æ›´æ–°è¡Œå·ï¼ˆä»¥æ¢è¡Œç¬¦ä¸ºå‡†ï¼Œä¸è®¡ç®—è½¯æ¢è¡Œï¼‰
      function updateLineNumbers(){
        const lines = pad.value.split('\n').length || 1;
        // ç”Ÿæˆ "1\n2\n3..." çš„å­—ç¬¦ä¸²
        let nums = '';
        // ä½¿ç”¨è¾ƒå¿«çš„æ„é€ æ–¹å¼é¿å…é¢‘ç¹æ‹¼æ¥å¼€é”€
        const arr = new Array(lines);
        for (let i=0;i<lines;i++){ arr[i] = String(i+1); }
        nums = arr.join('\n');
        gutter.textContent = nums;
        // åŠ¨æ€è°ƒæ•´è¡Œå·æ å®½åº¦ï¼ˆæŒ‰ä½æ•°ä¼°ç®—ï¼‰
        const digits = String(lines).length;
        gutter.style.setProperty('--digits', Math.max(2, digits));
      }

      function refresh(){
        autoResize();
      }

      // ä¸€é”®æ¸…ç©ºï¼ˆç¡®è®¤ï¼‰
      clearBtn.addEventListener('click', () => {
        const ok = confirm('ç¡®è®¤è¦æ¸…ç©ºå…¨éƒ¨å†…å®¹å—ï¼Ÿ');
        if(!ok) return;
        pad.value = '';
        refresh();
        pad.focus();
      });

      // ä¸€é”®å¤åˆ¶
      copyBtn.addEventListener('click', async () => {
        try{
          await navigator.clipboard.writeText(pad.value);
          showToast('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
        }catch(err){
          // å…¼å®¹æ—§ç¯å¢ƒçš„å›é€€æ–¹æ¡ˆ
          const sel = document.getSelection();
          const range = document.createRange();
          range.selectNodeContents(pad);
          sel.removeAllRanges(); sel.addRange(range);
          const ok = document.execCommand('copy');
          sel.removeAllRanges();
          showToast(ok ? 'å·²å¤åˆ¶åˆ°å‰ªè´´æ¿' : 'å¤åˆ¶å¤±è´¥');
        }
      });

      // å¯¼å‡ºä¸ºTXT
      function exportText(){
        try{
          const text = pad.value || '';
          const blob = new Blob([text], { type: 'text/plain;charset=utf-8' });
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          const now = new Date();
          const two = n => String(n).padStart(2, '0');
          const filename = `ç¬”è®°_${now.getFullYear()}${two(now.getMonth()+1)}${two(now.getDate())}_${two(now.getHours())}${two(now.getMinutes())}${two(now.getSeconds())}.txt`;
          a.href = url;
          a.download = filename;
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(url);
          showToast('å·²å¯¼å‡º TXT æ–‡ä»¶');
        }catch(err){
          showToast('å¯¼å‡ºå¤±è´¥');
          console.error(err);
        }
      }
      exportBtn.addEventListener('click', exportText);

      // æç¤ºå°æ°”æ³¡
      let toastTimer;
      function showToast(text){
        toast.textContent = text;
        toast.classList.add('show');
        clearTimeout(toastTimer);
        toastTimer = setTimeout(()=> toast.classList.remove('show'), 1600);
      }

      // è¾“å…¥æ—¶è”åŠ¨
      pad.addEventListener('input', refresh);
      // åˆæ¬¡æ¸²æŸ“
      window.addEventListener('DOMContentLoaded', ()=>{
        refresh();
        // è®©é¦–æ¬¡ç‚¹å‡»æ›´ä¸æ»‘
        pad.focus({preventScroll:true});
        // iOS è½¯é”®ç›˜é€‚é…ï¼šé¿å…å·¥å…·æ æŒ¡ä½
        window.scrollTo(0,0);
      });

      // å¤„ç†ç²˜è´´ç­‰çªå˜
      pad.addEventListener('paste', ()=> setTimeout(refresh, 0));

      // å¯é€‰ï¼šçª—å£å°ºå¯¸å˜åŒ–æ—¶ä¿æŒé«˜åº¦åˆç†
      window.addEventListener('resize', () => {
        // ä»…åœ¨å¯è§æ—¶æ›´æ–°ï¼Œé¿å…å¸ƒå±€æŠ–åŠ¨
        requestAnimationFrame(refresh);
      });
    })();
  </script></body>
</html>